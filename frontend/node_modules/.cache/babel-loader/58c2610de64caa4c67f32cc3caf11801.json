{"ast":null,"code":"import * as d3 from \"d3\";\nimport dataTransform from \"../dataTransform\";\nimport { attachEventListners, dispatch } from \"../events\";\nimport { colorParse } from \"../colorHelper\";\n/**\n * Reusable 3D Bar Chart Component\n *\n * @module\n */\n\nexport default function () {\n  /* Default Properties */\n  let dimensions = {\n    x: 40,\n    y: 40,\n    z: 2\n  };\n  let colors = [\"orange\", \"red\", \"yellow\", \"steelblue\", \"green\"];\n  let classed = \"d3X3dBars\";\n  /* Scales */\n\n  let xScale;\n  let yScale;\n  let colorScale;\n  /**\n   * Initialise Data and Scales\n   *\n   * @private\n   * @param {Array} data - Chart data.\n   */\n\n  const init = function (data) {\n    const {\n      columnKeys,\n      valueMax\n    } = dataTransform(data).summary();\n    const valueExtent = [0, valueMax];\n    const {\n      x: dimensionX,\n      y: dimensionY\n    } = dimensions;\n\n    if (typeof xScale === \"undefined\") {\n      xScale = d3.scaleBand().domain(columnKeys).rangeRound([0, dimensionX]).padding(0.3);\n    }\n\n    if (typeof yScale === \"undefined\") {\n      yScale = d3.scaleLinear().domain(valueExtent).range([0, dimensionY]);\n    }\n\n    if (typeof colorScale === \"undefined\") {\n      colorScale = d3.scaleOrdinal().domain(columnKeys).range(colors);\n    }\n  };\n  /**\n   * Constructor\n   *\n   * @constructor\n   * @alias bars\n   * @param {d3.selection} selection - The chart holder D3 selection.\n   */\n\n\n  const my = function (selection) {\n    selection.each(function (data) {\n      init(data);\n      const element = d3.select(this).classed(classed, true).attr(\"id\", d => d.key);\n\n      const shape = el => {\n        const shape = el.append(\"Shape\");\n        attachEventListners(shape);\n        shape.append(\"Box\").attr(\"size\", \"1.0 1.0 1.0\");\n        shape.append(\"Appearance\").append(\"Material\").attr(\"diffuseColor\", d => {\n          // If colour scale is linear then use value for scale.\n          let j = colorScale(d.key);\n\n          if (typeof colorScale.interpolate === \"function\") {\n            j = colorScale(d.value);\n          }\n\n          return colorParse(j);\n        }).attr(\"ambientIntensity\", 0.1);\n        return shape;\n      };\n\n      const bars = element.selectAll(\".bar\").data(d => d.values, d => d.key);\n      bars.enter().append(\"Transform\").classed(\"bar\", true).call(shape).merge(bars).transition().attr(\"scale\", d => {\n        let x = xScale.bandwidth();\n        let y = yScale(d.value);\n        let z = dimensions.z;\n        return x + \" \" + y + \" \" + z;\n      }).attr(\"translation\", d => {\n        let x = xScale(d.key);\n        let y = yScale(d.value) / 2;\n        let z = 0.0;\n        return x + \" \" + y + \" \" + z;\n      });\n      bars.exit().remove();\n    });\n  };\n  /**\n   * Dimensions Getter / Setter\n   *\n   * @param {{x: number, y: number, z: number}} _v - 3D object dimensions.\n   * @returns {*}\n   */\n\n\n  my.dimensions = function (_v) {\n    if (!arguments.length) return dimensions;\n    dimensions = _v;\n    return this;\n  };\n  /**\n   * X Scale Getter / Setter\n   *\n   * @param {d3.scale} _v - D3 scale.\n   * @returns {*}\n   */\n\n\n  my.xScale = function (_v) {\n    if (!arguments.length) return xScale;\n    xScale = _v;\n    return my;\n  };\n  /**\n   * Y Scale Getter / Setter\n   *\n   * @param {d3.scale} _v - D3 scale.\n   * @returns {*}\n   */\n\n\n  my.yScale = function (_v) {\n    if (!arguments.length) return yScale;\n    yScale = _v;\n    return my;\n  };\n  /**\n   * Color Scale Getter / Setter\n   *\n   * @param {d3.scale} _v - D3 scale.\n   * @returns {*}\n   */\n\n\n  my.colorScale = function (_v) {\n    if (!arguments.length) return colorScale;\n    colorScale = _v;\n    return my;\n  };\n  /**\n   * Colors Getter / Setter\n   *\n   * @param {Array} _v - Array of colours used by color scale.\n   * @returns {*}\n   */\n\n\n  my.colors = function (_v) {\n    if (!arguments.length) return colors;\n    colors = _v;\n    return my;\n  };\n  /**\n   * Dispatch On Getter\n   *\n   * @returns {*}\n   */\n\n\n  my.on = function () {\n    let value = dispatch.on.apply(dispatch, arguments);\n    return value === dispatch ? my : value;\n  };\n\n  return my;\n}","map":{"version":3,"sources":["C:/Users/Michael Wilke/Desktop/Scout/frontend/node_modules/d3-x3d/src/component/bars.js"],"names":["d3","dataTransform","attachEventListners","dispatch","colorParse","dimensions","x","y","z","colors","classed","xScale","yScale","colorScale","init","data","columnKeys","valueMax","summary","valueExtent","dimensionX","dimensionY","scaleBand","domain","rangeRound","padding","scaleLinear","range","scaleOrdinal","my","selection","each","element","select","attr","d","key","shape","el","append","j","interpolate","value","bars","selectAll","values","enter","call","merge","transition","bandwidth","exit","remove","_v","arguments","length","on","apply"],"mappings":"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","sourcesContent":["import * as d3 from \"d3\";\nimport dataTransform from \"../dataTransform\";\nimport { attachEventListners, dispatch } from \"../events\";\nimport { colorParse } from \"../colorHelper\";\n\n/**\n * Reusable 3D Bar Chart Component\n *\n * @module\n */\nexport default function() {\n\n\t/* Default Properties */\n\tlet dimensions = { x: 40, y: 40, z: 2 };\n\tlet colors = [\"orange\", \"red\", \"yellow\", \"steelblue\", \"green\"];\n\tlet classed = \"d3X3dBars\";\n\n\t/* Scales */\n\tlet xScale;\n\tlet yScale;\n\tlet colorScale;\n\n\t/**\n\t * Initialise Data and Scales\n\t *\n\t * @private\n\t * @param {Array} data - Chart data.\n\t */\n\tconst init = function(data) {\n\t\tconst { columnKeys, valueMax } = dataTransform(data).summary();\n\t\tconst valueExtent = [0, valueMax];\n\t\tconst { x: dimensionX, y: dimensionY } = dimensions;\n\n\t\tif (typeof xScale === \"undefined\") {\n\t\t\txScale = d3.scaleBand()\n\t\t\t\t.domain(columnKeys)\n\t\t\t\t.rangeRound([0, dimensionX])\n\t\t\t\t.padding(0.3);\n\t\t}\n\n\t\tif (typeof yScale === \"undefined\") {\n\t\t\tyScale = d3.scaleLinear()\n\t\t\t\t.domain(valueExtent)\n\t\t\t\t.range([0, dimensionY]);\n\t\t}\n\n\t\tif (typeof colorScale === \"undefined\") {\n\t\t\tcolorScale = d3.scaleOrdinal()\n\t\t\t\t.domain(columnKeys)\n\t\t\t\t.range(colors);\n\t\t}\n\t};\n\n\t/**\n\t * Constructor\n\t *\n\t * @constructor\n\t * @alias bars\n\t * @param {d3.selection} selection - The chart holder D3 selection.\n\t */\n\tconst my = function(selection) {\n\t\tselection.each(function(data) {\n\t\t\tinit(data);\n\n\t\t\tconst element = d3.select(this)\n\t\t\t\t.classed(classed, true)\n\t\t\t\t.attr(\"id\", (d) => d.key);\n\n\t\t\tconst shape = (el) => {\n\t\t\t\tconst shape = el.append(\"Shape\");\n\n\t\t\t\tattachEventListners(shape);\n\n\t\t\t\tshape.append(\"Box\")\n\t\t\t\t\t.attr(\"size\", \"1.0 1.0 1.0\");\n\n\t\t\t\tshape.append(\"Appearance\")\n\t\t\t\t\t.append(\"Material\")\n\t\t\t\t\t.attr(\"diffuseColor\", (d) => {\n\t\t\t\t\t\t// If colour scale is linear then use value for scale.\n\t\t\t\t\t\tlet j = colorScale(d.key);\n\t\t\t\t\t\tif (typeof colorScale.interpolate === \"function\") {\n\t\t\t\t\t\t\tj = colorScale(d.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn colorParse(j)\n\t\t\t\t\t})\n\t\t\t\t\t.attr(\"ambientIntensity\", 0.1);\n\n\t\t\t\treturn shape;\n\t\t\t};\n\n\t\t\tconst bars = element.selectAll(\".bar\")\n\t\t\t\t.data((d) => d.values, (d) => d.key);\n\n\t\t\tbars.enter()\n\t\t\t\t.append(\"Transform\")\n\t\t\t\t.classed(\"bar\", true)\n\t\t\t\t.call(shape)\n\t\t\t\t.merge(bars)\n\t\t\t\t.transition()\n\t\t\t\t.attr(\"scale\", (d) => {\n\t\t\t\t\tlet x = xScale.bandwidth();\n\t\t\t\t\tlet y = yScale(d.value);\n\t\t\t\t\tlet z = dimensions.z;\n\t\t\t\t\treturn x + \" \" + y + \" \" + z;\n\t\t\t\t})\n\t\t\t\t.attr(\"translation\", (d) => {\n\t\t\t\t\tlet x = xScale(d.key);\n\t\t\t\t\tlet y = yScale(d.value) / 2;\n\t\t\t\t\tlet z = 0.0;\n\t\t\t\t\treturn x + \" \" + y + \" \" + z;\n\t\t\t\t});\n\n\t\t\tbars.exit()\n\t\t\t\t.remove();\n\t\t});\n\t};\n\n\t/**\n\t * Dimensions Getter / Setter\n\t *\n\t * @param {{x: number, y: number, z: number}} _v - 3D object dimensions.\n\t * @returns {*}\n\t */\n\tmy.dimensions = function(_v) {\n\t\tif (!arguments.length) return dimensions;\n\t\tdimensions = _v;\n\t\treturn this;\n\t};\n\n\t/**\n\t * X Scale Getter / Setter\n\t *\n\t * @param {d3.scale} _v - D3 scale.\n\t * @returns {*}\n\t */\n\tmy.xScale = function(_v) {\n\t\tif (!arguments.length) return xScale;\n\t\txScale = _v;\n\t\treturn my;\n\t};\n\n\t/**\n\t * Y Scale Getter / Setter\n\t *\n\t * @param {d3.scale} _v - D3 scale.\n\t * @returns {*}\n\t */\n\tmy.yScale = function(_v) {\n\t\tif (!arguments.length) return yScale;\n\t\tyScale = _v;\n\t\treturn my;\n\t};\n\n\t/**\n\t * Color Scale Getter / Setter\n\t *\n\t * @param {d3.scale} _v - D3 scale.\n\t * @returns {*}\n\t */\n\tmy.colorScale = function(_v) {\n\t\tif (!arguments.length) return colorScale;\n\t\tcolorScale = _v;\n\t\treturn my;\n\t};\n\n\t/**\n\t * Colors Getter / Setter\n\t *\n\t * @param {Array} _v - Array of colours used by color scale.\n\t * @returns {*}\n\t */\n\tmy.colors = function(_v) {\n\t\tif (!arguments.length) return colors;\n\t\tcolors = _v;\n\t\treturn my;\n\t};\n\n\t/**\n\t * Dispatch On Getter\n\t *\n\t * @returns {*}\n\t */\n\tmy.on = function() {\n\t\tlet value = dispatch.on.apply(dispatch, arguments);\n\t\treturn value === dispatch ? my : value;\n\t};\n\n\treturn my;\n}\n"]},"metadata":{},"sourceType":"module"}